{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\ClaimChain\\\\Simple-VRF-Game\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\ClaimChain\\\\Simple-VRF-Game\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React,{Component}from'react';import Loading from'./Loading';import Navbar from'./Navbar';import Main from'./Main';import Web3 from'web3';import'./App.css';class App extends Component{componentWillMount(){var _this=this;return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.loadWeb3();case 2:case\"end\":return _context.stop();}}},_callee);}))();}/** !UPDATE **/loadWeb3(){var _this2=this;return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var accounts,network,balance,web3,maxBet,minBet,contract,contract_abi,contract_address;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(typeof window.ethereum!=='undefined'&&!_this2.state.wrongNetwork)){_context4.next=24;break;}//don't refresh DApp when user change the network\nwindow.ethereum.autoRefreshOnNetworkChange=false;web3=new Web3(window.ethereum);_this2.setState({web3:web3});contract_abi=[{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"sender\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"Received\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"bet\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"randomSeed\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"player\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"winAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"randomResult\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"time\",\"type\":\"uint256\"}],\"name\":\"Result\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"address\",\"name\":\"admin\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"Withdraw\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bet\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"seed\",\"type\":\"uint256\"}],\"name\":\"game\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"requestId\",\"type\":\"bytes32\"},{\"internalType\":\"uint256\",\"name\":\"randomness\",\"type\":\"uint256\"}],\"name\":\"rawFulfillRandomness\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_keyHash\",\"type\":\"bytes32\"},{\"internalType\":\"uint256\",\"name\":\"_fee\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_seed\",\"type\":\"uint256\"}],\"name\":\"requestRandomness\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"requestId\",\"type\":\"bytes32\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"random\",\"type\":\"uint256\"}],\"name\":\"verdict\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"withdrawEther\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"withdrawLink\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"admin\",\"outputs\":[{\"internalType\":\"address payable\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"ethInUsd\",\"outputs\":[{\"internalType\":\"int256\",\"name\":\"\",\"type\":\"int256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"gameId\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"games\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"bet\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"seed\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"internalType\":\"address payable\",\"name\":\"player\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"lastGameId\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"nonces\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"randomResult\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"weiInUsd\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}];contract_address='0xEa88aD9AA78a4b4f6deD5346Ab490B13268FeCE1';//rinkeby\ncontract=new web3.eth.Contract(contract_abi,contract_address);_context4.next=9;return web3.eth.getAccounts();case 9:accounts=_context4.sent;if(!(typeof accounts[0]!=='undefined'&&accounts[0]!==null)){_context4.next=21;break;}_context4.next=13;return web3.eth.getBalance(accounts[0]);case 13:balance=_context4.sent;_context4.next=16;return web3.eth.getBalance(contract_address);case 16:maxBet=_context4.sent;_context4.next=19;return contract.methods.weiInUsd().call();case 19:minBet=_context4.sent;_this2.setState({account:accounts[0],balance:balance,minBet:minBet,maxBet:maxBet});case 21:_this2.setState({contract:contract,contractAddress:contract_address});//Update account&balance when user change the account\nwindow.ethereum.on('accountsChanged',/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(accounts){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(typeof accounts[0]!=='undefined'&&accounts[0]!==null)){_context2.next=13;break;}_context2.next=3;return web3.eth.getBalance(accounts[0]);case 3:balance=_context2.sent;_context2.next=6;return web3.eth.getBalance(contract_address);case 6:maxBet=_context2.sent;_context2.next=9;return contract.methods.weiInUsd().call();case 9:minBet=_context2.sent;_this2.setState({account:accounts[0],balance:balance,minBet:minBet,maxBet:maxBet});_context2.next=14;break;case 13:_this2.setState({account:null,balance:0});case 14:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}());//Update data when user switch the network\nwindow.ethereum.on('chainChanged',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(chainId){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:network=parseInt(chainId,16);if(!(network!==4)){_context3.next=5;break;}_this2.setState({wrongNetwork:true});_context3.next=17;break;case 5:if(!_this2.state.account){_context3.next=16;break;}_context3.next=8;return _this2.state.web3.eth.getBalance(_this2.state.account);case 8:balance=_context3.sent;_context3.next=11;return _this2.state.web3.eth.getBalance(_this2.state.contractAddress);case 11:maxBet=_context3.sent;_context3.next=14;return _this2.state.contract.methods.weiInUsd().call();case 14:minBet=_context3.sent;_this2.setState({balance:balance,maxBet:maxBet,minBet:minBet});case 16:_this2.setState({network:network,loading:false,onlyNetwork:false,wrongNetwork:false});case 17:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref2.apply(this,arguments);};}());case 24:case\"end\":return _context4.stop();}}},_callee4);}))();}makeBet(bet,amount){var _this3=this;return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var networkId,randomSeed;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return _this3.state.web3.eth.net.getId();case 2:networkId=_context6.sent;if(networkId!==4){_this3.setState({wrongNetwork:true});}else if(typeof _this3.state.account!=='undefined'&&_this3.state.account!==null){randomSeed=Math.floor(Math.random()*Math.floor(1e9));//Send bet to the contract and wait for the verdict\n_this3.state.contract.methods.game(bet,randomSeed).send({from:_this3.state.account,value:amount}).on('transactionHash',hash=>{_this3.setState({loading:true});_this3.state.contract.events.Result({},/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(error,event){var verdict,balance,maxBet;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:verdict=event.returnValues.winAmount;if(verdict==='0'){window.alert('lose :(');}else{window.alert('WIN!');}//Prevent error when user logout, while waiting for the verdict\nif(!(_this3.state.account!==null&&typeof _this3.state.account!=='undefined')){_context5.next=10;break;}_context5.next=5;return _this3.state.web3.eth.getBalance(_this3.state.account);case 5:balance=_context5.sent;_context5.next=8;return _this3.state.web3.eth.getBalance(_this3.state.contractAddress);case 8:maxBet=_context5.sent;_this3.setState({balance:balance,maxBet:maxBet});case 10:_this3.setState({loading:false});case 11:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x3,_x4){return _ref3.apply(this,arguments);};}());}).on('error',error=>{window.alert('Error');});}else{window.alert('Problem with account or network');}case 4:case\"end\":return _context6.stop();}}},_callee6);}))();}onChange(value){this.setState({'amount':value});}constructor(props){super(props);this.state={account:null,amount:null,balance:null,contract:null,event:null,loading:false,network:null,maxBet:0,minBet:0,web3:null,wrongNetwork:false,contractAddress:null};this.makeBet=this.makeBet.bind(this);this.setState=this.setState.bind(this);this.onChange=this.onChange.bind(this);}render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Navbar,{account:this.state.account}),\"\\xA0\",this.state.wrongNetwork?/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid mt-5 text-monospace text-center mr-auto ml-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content mr-auto ml-auto\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Please Enter Rinkeby Network\"))):this.state.loading?/*#__PURE__*/React.createElement(Loading,{balance:this.state.balance,maxBet:this.state.maxBet,minBet:this.state.minBet,web3:this.state.web3}):/*#__PURE__*/React.createElement(Main,{amount:this.state.amount,balance:this.state.balance,makeBet:this.makeBet,onChange:this.onChange,maxBet:this.state.maxBet,minBet:this.state.minBet,loading:this.state.loading,web3:this.state.web3}));}}export default App;","map":{"version":3,"sources":["C:/Users/ClaimChain/Simple-VRF-Game/src/components/App.js"],"names":["React","Component","Loading","Navbar","Main","Web3","App","componentWillMount","loadWeb3","window","ethereum","state","wrongNetwork","autoRefreshOnNetworkChange","web3","setState","contract_abi","contract_address","contract","eth","Contract","getAccounts","accounts","getBalance","balance","maxBet","methods","weiInUsd","call","minBet","account","contractAddress","on","chainId","network","parseInt","loading","onlyNetwork","makeBet","bet","amount","net","getId","networkId","randomSeed","Math","floor","random","game","send","from","value","hash","events","Result","error","event","verdict","returnValues","winAmount","alert","onChange","constructor","props","bind","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Loading from './Loading'\r\nimport Navbar from './Navbar'\r\nimport Main from './Main'\r\nimport Web3 from 'web3'\r\nimport './App.css';\r\n\r\n\r\nclass App extends Component {\r\n  \r\n  async componentWillMount() {\r\n    await this.loadWeb3()\r\n  }\r\n\r\n  /** !UPDATE **/\r\n  async loadWeb3() {\r\n    if(typeof window.ethereum!=='undefined' && !this.state.wrongNetwork){\r\n      let accounts, network, balance, web3, maxBet, minBet, contract, contract_abi, contract_address\r\n\r\n      //don't refresh DApp when user change the network\r\n      window.ethereum.autoRefreshOnNetworkChange = false;\r\n\r\n      web3 = new Web3(window.ethereum)\r\n      this.setState({web3: web3})\r\n\r\n      contract_abi = [{\"anonymous\": false,\"inputs\": [{\"indexed\": true,\"internalType\": \"address\",\"name\": \"sender\",\"type\": \"address\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"amount\",\"type\": \"uint256\"}],\"name\": \"Received\",\"type\": \"event\"},{\"anonymous\": false,\"inputs\": [{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"id\",\"type\": \"uint256\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"bet\",\"type\": \"uint256\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"randomSeed\",\"type\": \"uint256\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"amount\",\"type\": \"uint256\"},{\"indexed\": false,\"internalType\": \"address\",\"name\": \"player\",\"type\": \"address\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"winAmount\",\"type\": \"uint256\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"randomResult\",\"type\": \"uint256\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"time\",\"type\": \"uint256\"}],\"name\": \"Result\",\"type\": \"event\"},{\"anonymous\": false,\"inputs\": [{\"indexed\": false,\"internalType\": \"address\",\"name\": \"admin\",\"type\": \"address\"},{\"indexed\": false,\"internalType\": \"uint256\",\"name\": \"amount\",\"type\": \"uint256\"}],\"name\": \"Withdraw\",\"type\": \"event\"},{\"inputs\": [{\"internalType\": \"uint256\",\"name\": \"bet\",\"type\": \"uint256\"},{\"internalType\": \"uint256\",\"name\": \"seed\",\"type\": \"uint256\"}],\"name\": \"game\",\"outputs\": [{\"internalType\": \"bool\",\"name\": \"\",\"type\": \"bool\"}],\"stateMutability\": \"payable\",\"type\": \"function\"},{\"inputs\": [{\"internalType\": \"bytes32\",\"name\": \"requestId\",\"type\": \"bytes32\"},{\"internalType\": \"uint256\",\"name\": \"randomness\",\"type\": \"uint256\"}],\"name\": \"rawFulfillRandomness\",\"outputs\": [],\"stateMutability\": \"nonpayable\",\"type\": \"function\"},{\"inputs\": [{\"internalType\": \"bytes32\",\"name\": \"_keyHash\",\"type\": \"bytes32\"},{\"internalType\": \"uint256\",\"name\": \"_fee\",\"type\": \"uint256\"},{\"internalType\": \"uint256\",\"name\": \"_seed\",\"type\": \"uint256\"}],\"name\": \"requestRandomness\",\"outputs\": [{\"internalType\": \"bytes32\",\"name\": \"requestId\",\"type\": \"bytes32\"}],\"stateMutability\": \"nonpayable\",\"type\": \"function\"},{\"stateMutability\": \"payable\",\"type\": \"receive\"},{\"inputs\": [{\"internalType\": \"uint256\",\"name\": \"random\",\"type\": \"uint256\"}],\"name\": \"verdict\",\"outputs\": [],\"stateMutability\": \"payable\",\"type\": \"function\"},{\"inputs\": [{\"internalType\": \"uint256\",\"name\": \"amount\",\"type\": \"uint256\"}],\"name\": \"withdrawEther\",\"outputs\": [],\"stateMutability\": \"payable\",\"type\": \"function\"},{\"inputs\": [{\"internalType\": \"uint256\",\"name\": \"amount\",\"type\": \"uint256\"}],\"name\": \"withdrawLink\",\"outputs\": [],\"stateMutability\": \"nonpayable\",\"type\": \"function\"},{\"inputs\": [],\"stateMutability\": \"nonpayable\",\"type\": \"constructor\"},{\"inputs\": [],\"name\": \"admin\",\"outputs\": [{\"internalType\": \"address payable\",\"name\": \"\",\"type\": \"address\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [],\"name\": \"ethInUsd\",\"outputs\": [{\"internalType\": \"int256\",\"name\": \"\",\"type\": \"int256\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [],\"name\": \"gameId\",\"outputs\": [{\"internalType\": \"uint256\",\"name\": \"\",\"type\": \"uint256\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [{\"internalType\": \"uint256\",\"name\": \"\",\"type\": \"uint256\"}],\"name\": \"games\",\"outputs\": [{\"internalType\": \"uint256\",\"name\": \"id\",\"type\": \"uint256\"},{\"internalType\": \"uint256\",\"name\": \"bet\",\"type\": \"uint256\"},{\"internalType\": \"uint256\",\"name\": \"seed\",\"type\": \"uint256\"},{\"internalType\": \"uint256\",\"name\": \"amount\",\"type\": \"uint256\"},{\"internalType\": \"address payable\",\"name\": \"player\",\"type\": \"address\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [],\"name\": \"lastGameId\",\"outputs\": [{\"internalType\": \"uint256\",\"name\": \"\",\"type\": \"uint256\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [{\"internalType\": \"bytes32\",\"name\": \"\",\"type\": \"bytes32\"}],\"name\": \"nonces\",\"outputs\": [{\"internalType\": \"uint256\",\"name\": \"\",\"type\": \"uint256\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [],\"name\": \"randomResult\",\"outputs\": [{\"internalType\": \"uint256\",\"name\": \"\",\"type\": \"uint256\"}],\"stateMutability\": \"view\",\"type\": \"function\"},{\"inputs\": [],\"name\": \"weiInUsd\",\"outputs\": [{\"internalType\": \"uint256\",\"name\": \"\",\"type\": \"uint256\"}],\"stateMutability\": \"view\",\"type\": \"function\"}]\r\n      contract_address = '0xEa88aD9AA78a4b4f6deD5346Ab490B13268FeCE1' //rinkeby\r\n      contract = new web3.eth.Contract(contract_abi, contract_address);\r\n      accounts = await web3.eth.getAccounts()\r\n      \r\n      //Update the data when user initially connect\r\n      if(typeof accounts[0]!=='undefined' && accounts[0]!==null) {\r\n        balance = await web3.eth.getBalance(accounts[0])\r\n        maxBet = await web3.eth.getBalance(contract_address)\r\n        minBet = await contract.methods.weiInUsd().call()\r\n        this.setState({account: accounts[0], balance: balance, minBet: minBet, maxBet: maxBet})\r\n      }\r\n\r\n      this.setState({\r\n        contract: contract,\r\n        contractAddress: contract_address\r\n      })\r\n\r\n      //Update account&balance when user change the account\r\n      window.ethereum.on('accountsChanged', async (accounts) => {\r\n        if(typeof accounts[0] !== 'undefined'  && accounts[0]!==null){\r\n          balance = await web3.eth.getBalance(accounts[0])\r\n          maxBet = await web3.eth.getBalance(contract_address)\r\n          minBet = await contract.methods.weiInUsd().call()\r\n          \r\n          this.setState({account: accounts[0], balance: balance, minBet: minBet, maxBet: maxBet})\r\n        } else {\r\n          this.setState({account: null, balance: 0})\r\n        }\r\n      });\r\n\r\n      //Update data when user switch the network\r\n      window.ethereum.on('chainChanged', async (chainId) => {\r\n        network = parseInt(chainId, 16)\r\n        if(network!==4){\r\n          this.setState({wrongNetwork: true})\r\n        } else {\r\n          if(this.state.account){\r\n            balance = await this.state.web3.eth.getBalance(this.state.account)\r\n            maxBet = await this.state.web3.eth.getBalance(this.state.contractAddress)\r\n            minBet = await this.state.contract.methods.weiInUsd().call()\r\n            \r\n            this.setState({ balance: balance, maxBet: maxBet, minBet: minBet })\r\n          }\r\n          this.setState({ network: network, loading: false, onlyNetwork: false, wrongNetwork: false})\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  async makeBet(bet, amount) {\r\n    //randomSeed - one of the components from which will be generated final random value\r\n    const networkId = await this.state.web3.eth.net.getId() \r\n    if(networkId!==4) {\r\n      this.setState({wrongNetwork: true})\r\n    } else if(typeof this.state.account !=='undefined' && this.state.account !==null){\r\n      var randomSeed = Math.floor(Math.random() * Math.floor(1e9))\r\n\r\n      //Send bet to the contract and wait for the verdict\r\n      this.state.contract.methods.game(bet, randomSeed).send({from: this.state.account, value: amount}).on('transactionHash', (hash) => {\r\n        this.setState({ loading: true })\r\n        this.state.contract.events.Result({}, async (error, event) => {\r\n          const verdict = event.returnValues.winAmount\r\n          if(verdict === '0') {\r\n            window.alert('lose :(')\r\n          } else {\r\n            window.alert('WIN!')\r\n          }\r\n\r\n          //Prevent error when user logout, while waiting for the verdict\r\n          if(this.state.account!==null && typeof this.state.account!=='undefined'){\r\n            const balance = await this.state.web3.eth.getBalance(this.state.account)\r\n            const maxBet = await this.state.web3.eth.getBalance(this.state.contractAddress)\r\n            this.setState({ balance: balance, maxBet: maxBet })\r\n          }\r\n          this.setState({ loading: false })\r\n        })\r\n      }).on('error', (error) => {\r\n        window.alert('Error')\r\n      })\r\n    } else {\r\n      window.alert('Problem with account or network')\r\n    }\r\n  }\r\n\r\n  onChange(value) {\r\n    this.setState({'amount': value});\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      account: null,\r\n      amount: null,\r\n      balance: null,\r\n      contract: null,\r\n      event: null,\r\n      loading: false,\r\n      network: null,\r\n      maxBet: 0,\r\n      minBet: 0,\r\n      web3: null,\r\n      wrongNetwork: false,\r\n      contractAddress: null\r\n    }\r\n\r\n    this.makeBet = this.makeBet.bind(this)\r\n    this.setState = this.setState.bind(this)\r\n    this.onChange = this.onChange.bind(this)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Navbar account={this.state.account}/>&nbsp;\r\n        {this.state.wrongNetwork\r\n          ? <div className=\"container-fluid mt-5 text-monospace text-center mr-auto ml-auto\">\r\n              <div className=\"content mr-auto ml-auto\">\r\n                <h1>Please Enter Rinkeby Network</h1>\r\n              </div>\r\n            </div>\r\n          : this.state.loading \r\n              ? <Loading\r\n                  balance={this.state.balance}\r\n                  maxBet={this.state.maxBet}\r\n                  minBet={this.state.minBet}\r\n                  web3={this.state.web3}\r\n                />\r\n              : <Main\r\n                  amount={this.state.amount}\r\n                  balance={this.state.balance}\r\n                  makeBet={this.makeBet}\r\n                  onChange={this.onChange}\r\n                  maxBet={this.state.maxBet}\r\n                  minBet={this.state.minBet}\r\n                  loading={this.state.loading}\r\n                  web3={this.state.web3}\r\n                />\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;"]},"metadata":{},"sourceType":"module"}